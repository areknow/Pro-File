function checkIfReadyToRun(){xmlIsReady&&zipIsReady&&$(".button3").toggleClass("disabled")}function clickProfileUpload(){var e=$("#fileProfile").val().split(".").pop().toLowerCase();-1==$.inArray(e,["xml"])?showtoast("only .xml is allowed"):$("#profileUpload").click()}function clickDashboardUpload(){var e=$("#fileDash").val().split(".").pop().toLowerCase();-1==$.inArray(e,["zip"])?showtoast("only .zip is allowed"):$("#dashboardUpload").click()}function guid(){return s4()+s4()+"-"+s4()+"-"+s4()+"-"+s4()+"-"+s4()+s4()+s4()}function s4(){return Math.floor(65536*(1+Math.random())).toString(16).substring(1)}function newUser(){id=guid(),$(".guid").val(id),console.log(id)}function resetUser(){$.ajax({type:"POST",url:"php/unlink.php",data:{id:id},success:function(e){console.log(e)}}),$(".button1").toggleClass("disabled"),$(".button2").toggleClass("disabled"),$("#fileProfile").val(""),$("#fileDash").val(""),$("#uploadFormProfile .title").html("Choose system profile"),$("#uploadFormDashboard .title").html("Choose dashboard archive"),console.log("user has been reset"),newUser()}function setCookie(e,t,o){var s=new Date;s.setTime(s.getTime()+24*o*60*60*1e3);var a="expires="+s.toUTCString();document.cookie=e+"="+t+";"+a+";path=/"}function getCookie(e){for(var t=e+"=",o=document.cookie.split(";"),s=0;s<o.length;s++){for(var a=o[s];" "==a.charAt(0);)a=a.substring(1);if(0==a.indexOf(t))return a.substring(t.length,a.length)}return""}function checkCookie(){var e=getCookie("firsttimeprofile");""!=e||(setCookie("firsttimeprofile","set",365),$(".modal-cover").fadeToggle())}function ToastBuilder(e){var t=e||{};return t.defaultText=t.defaultText||"default text",t.displayTime=t.displayTime||3e3,t.target=t.target||"body",function(e){$("<div/>").addClass("toast").prependTo($(t.target)).text(e||t.defaultText).queue(function(e){$(this).css({opacity:1});var t=15;$(".toast").each(function(){var e=$(this),o=e.outerHeight(),s=15;e.css("top",t+"px"),t+=o+s}),e()}).delay(t.displayTime).queue(function(e){var t=$(this),o=t.outerWidth()+20;t.css({right:"-"+o+"px",opacity:0}),e()}).delay(600).queue(function(e){$(this).remove(),e()})}}var id,xmlIsReady=!1,zipIsReady=!1,showtoast=new ToastBuilder;$(document).ready(function(){checkCookie(),newUser(),$("#uploadFormProfile").on("submit",function(e){e.preventDefault(),$.ajax({url:"php/upload.php",type:"POST",data:new FormData(this),contentType:!1,cache:!1,processData:!1,success:function(e){var t=$.parseJSON(e);console.log(t),$("#uploadFormProfile .title").html(t[1]),"0"==t[0]?(xmlIsReady=!0,showtoast("system profile ready")):"1"==t[1]&&(xmlIsReady=!1),checkIfReadyToRun()},error:function(){console.log(e)}})}),$("#uploadFormDashboard").on("submit",function(e){e.preventDefault(),$.ajax({url:"php/upload.php",type:"POST",data:new FormData(this),contentType:!1,cache:!1,processData:!1,success:function(e){var t=$.parseJSON(e);console.log(t),$("#uploadFormDashboard .title").html(t[1]),"0"==t[0]?(zipIsReady=!0,showtoast("dashboards ready")):"1"==t[1]&&(zipIsReady=!1),checkIfReadyToRun()},error:function(){console.log(e)}})}),$("#runner").click(function(){$(".button").toggleClass("disabled"),console.log("begin fetch"),showtoast("running..."),$("#runner-icon").toggleClass("bt-spin"),$("#runner .title").html("Searching for measures"),$.ajax({type:"POST",url:"php/parse.php",data:{id:id},cache:!1,success:function(e){var t=$.parseJSON(e);console.log(t),console.log(t.length),$(".button-row").toggleClass("button-row-adjusted"),$("#output").fadeToggle(),$("#measure-count span").html(t.length);var o=$("#output ul");$.each(t,function(e){$("<li/>").appendTo(o).text(t[e])}),console.log("end fetch"),showtoast("done!"),$("#runner-icon").toggleClass("bt-spin"),$("#runner .title").html("Search for measures"),resetUser()}})}),$("#close-output").click(function(){$(".button-row").toggleClass("button-row-adjusted"),$("#output").fadeToggle(),$("#output ul").html("")}),$(".info-button, #modal-close").click(function(){$(".modal-cover").fadeToggle()})});
//# sourceMappingURL=init.min.js.map